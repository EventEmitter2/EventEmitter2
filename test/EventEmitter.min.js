(function(b){var d={EventEmitter:function(){}};var c=b.EventEmitter=d.EventEmitter;var a=Array.isArray;c.prototype.emit=function(k){if(k==="error"){if(!this._events||!this._events.error||(a(this._events.error)&&!this._events.error.length)){if(arguments[1] instanceof Error){throw arguments[1]}else{throw new Error("Uncaught, unspecified 'error' event.")}return false}}if(!this._events){return false}var j=this._events[k];if(!j){return false}if(typeof j=="function"){switch(arguments.length){case 1:j.call(this);break;case 2:j.call(this,arguments[1]);break;case 3:j.call(this,arguments[1],arguments[2]);break;default:var f=Array.prototype.slice.call(arguments,1);j.apply(this,f)}return true}else{if(a(j)){var f=Array.prototype.slice.call(arguments,1);var h=j.slice();for(var g=0,e=h.length;g<e;g++){h[g].apply(this,f)}return true}else{return false}}};c.prototype.addListener=function(e,f){if("function"!==typeof f){throw new Error("addListener only takes instances of Function")}if(!this._events){this._events={}}this.emit("newListener",e,f);if(!this._events[e]){this._events[e]=f}else{if(a(this._events[e])){this._events[e].push(f)}else{this._events[e]=[this._events[e],f]}}return this};c.prototype.on=c.prototype.addListener;c.prototype.once=function(f,i){var e=this;e.on(f,function h(){e.removeListener(f,h);i.apply(this,arguments)})};c.prototype.removeListener=function(f,h){if("function"!==typeof h){throw new Error("removeListener only takes instances of Function")}if(!this._events||!this._events[f]){return this}var g=this._events[f];if(a(g)){var e=g.indexOf(h);if(e<0){return this}g.splice(e,1);if(g.length==0){delete this._events[f]}}else{if(this._events[f]===h){delete this._events[f]}}return this};c.prototype.removeAllListeners=function(e){if(e&&this._events&&this._events[e]){this._events[e]=null}return this};c.prototype.listeners=function(e){if(!this._events){this._events={}}if(!this._events[e]){this._events[e]=[]}if(!a(this._events[e])){this._events[e]=[this._events[e]]}return this._events[e]}}((typeof exports==="undefined")?window:exports));